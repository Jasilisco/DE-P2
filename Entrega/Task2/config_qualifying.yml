datasources: 
  qualifying: 
    name: "../DATASETS/qualifying.csv"
    base: true
  races: 
    name: "../DATASETS/races.csv"
    mergeLogic:
      base: raceId
      field: raceId
  drivers:
    name: "../DATASETS/drivers.csv"
    mergeLogic:
      base: driverId
      field: driverId
  circuits:
    name: "../DATASETS/circuits.csv"
    mergeLogic:
      base: circuitId
      field: circuitId
    rename:
      alt: altitude
      lat: latitude
      lng: longitude

database:
  sqlScript: './f1_qualifying.sql'
  user: root
  password: admin
  host: localhost
  port: 3306
  name: f1_qualifying

tables:
  dim_driver:
    driverId: {autogenerated: true}
    driver_nk : driverId
    driver_ref: driverRef
    code: code
    forename: forename
    surname: surname
    nationality: nationality
    number: number
  
  dim_constructor:
    constructorId: {autogenerated: true}
    constructor_nk: constructorId
    constructor_ref: constructorRef
    name: name
    country: nationality
    url: url

  dim_circuit:
    circuitId: {autogenerated: true}
    circuit_nk: circuitId
    circuit_ref: circuitRef
    name: name
    location: location
    country: country
    altitude: altitude
    latitude: latitude
    longitude: longitude
  
  dim_date:
    dateId: {autogenerated: true}
    date: date
    year: {value: date, date: true}
    month: {value: date, date: true}
    day: {value: date, date: true}
    day_of_week: {value: date, day: true}

  dim_race:
    raceId: {autogenerated: true}
    race_nk: raceId
    name: name
    round : round
    year: {value: date, date: true}
    url: url

  fact_qualifying:
    qualifyingId: {autogenerated: true}
    race_id: {fk: dim_race}
    driver_id: {fk: dim_driver}
    constructor_id: {fk: dim_constructor}
    circuit_id: {fk: dim_circuit}
    date_id: {fk: dim_date}

    q1_str: q1
    q2_str: q2
    q3_str: q3

    q1_sec: {value: q1, duration_sec: true}
    q2_sec: {value: q2, duration_sec: true}
    q3_sec: {value: q3, duration_sec: true}

    position: position

config:
  dim_driver:
    design:
      value: dimension
      hash:
        base: [driver_nk]
    id: driverId
    onDuplicate:
      method: ignore
  
  dim_constructor:
    design:
      value: dimension
      hash:
        base: [constructor_nk]
    id: constructorId
    onDuplicate:
      method: ignore

  dim_circuit:
    design:
      value: dimension
      hash:
        base: [circuit_nk]
    id: circuitId
    onDuplicate:
      method: ignore

  dim_date:
    design:
      value: dimension
      hash:
        base: [date]
    id: dateId
    onDuplicate:
      method: ignore

  dim_race:
    design:
      value: dimension
      hash:
        base: [race_nk]
    id: raceId
    onDuplicate:
      method: ignore

  fact_qualifying:
    design: fact
    id: [race_id, driver_id]
    onDuplicate:
      method: update
    
    onNull:
      method: default
      criteria:
        q1_sec: null
        q2_sec: null
        q3_sec: null
        q1_str: null
        q2_str: null
        q3_str: null
        position: null
